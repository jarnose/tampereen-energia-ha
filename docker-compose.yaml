services:
  tampere_energy_scraper:
    build: .
    container_name: tampere_energy
    restart: unless-stopped

    # Map the host's log folder to the container
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data
      - /etc/localtime:/etc/localtime:ro  # <--- Forces container to match host clock
      - /etc/timezone:/etc/timezone:ro    # <--- Forces container to match host timezone

    # Prevent Docker system logs from growing infinitely
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

    environment:
      # Timezone ensures the schedule runs at 08:15 Finnish time, not UTC
      - PYTHONUNBUFFERED=1
      - TZ=Europe/Helsinki
      - RUN_TIME=8:15
      # Tampereen Energia Credentials
      - TE_USERNAME=
      - TE_PASSWORD=
      - TE_METERINGPOINT=
      # Home Assistant WebSocket Details
      - HA_URL=ws://192.168.X.X:8123/api/websocket
      - HA_TOKEN=
